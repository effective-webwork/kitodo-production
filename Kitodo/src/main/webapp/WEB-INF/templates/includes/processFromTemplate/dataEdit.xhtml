<!--
 *
 * (c) Kitodo. Key to digital objects e. V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo project.
 *
 * It is licensed under GNU General Public License version 3 or later.
 *
 * For the full copyright and license information, please read the
 * GPL3-License.txt file that was distributed with this source code.
 *
-->

<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://xmlns.jcp.org/jsf/core"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:p="http://primefaces.org/ui">

    <div class="basicDataTitle">
        <h:outputText value="#{msgs.basicData}"/>
    </div>
    <p:panelGrid id="processDataEditGrid" layout="grid" columns="2">
        <p:row>
            <div>
                <!-- process title -->
                <p:outputLabel for="processTitle" value="#{msgs.processTitle}"/>
                <p:inputText id="processTitle"
                             value="#{CreateProcessForm.mainProcess.title}"
                             styleClass="input-with-button"
                             required="#{not empty param['editForm:save'] or not empty param['editForm:saveContinue']}">
                    <p:ajax event="change"/>
                </p:inputText>
                <p:commandButton id="generateTitleButton"
                                 process="@this"
                                 actionListener="#{CreateProcessForm.processDataTab.generateProcessTitleAndTiffHeader}"
                                 icon="fa fa-cog" title="#{msgs.generate}" resetValues="true"/>
            </div>

            <div>
                <!-- DocType -->
                <p:outputLabel value="DocType"/>
                <p:selectOneMenu id="docType" value="#{CreateProcessForm.processDataTab.docType}">
                    <f:selectItems value="#{CreateProcessForm.processDataTab.allDoctypes}"
                                   var="step"
                                   itemLabel="#{step.localizedLabel}"
                                   itemValue="#{step.title}"/>
                    <p:ajax event="change"
                            listener="#{CreateProcessForm.titleRecordLinkTab.createInsertionPositionSelectionTree()}"
                            update="editForm:processFromTemplateTabView:metadataTable,editForm:processFromTemplateTabView:insertionTree"/>
                </p:selectOneMenu>
            </div>

            <h:panelGroup layout="block"
                          title="#{msgs['newProcess.rulesetSelection.deactivated']}">
                <p:outputLabel for="ruleset"
                               value="#{msgs.ruleset}"/>
                <p:inputText id="ruleset"
                             styleClass="input"
                             disabled="#{true}"
                             value="#{CreateProcessForm.mainProcess.ruleset.title}"/>
            </h:panelGroup>

            <div>
                <p:outputLabel for="usingTemplates"
                               value="#{msgs.processTemplate}"
                               rendered="#{CreateProcessForm.processDataTab.usingTemplates}"/>
                <p:selectBooleanCheckbox styleClass="switch input"
                                         id="usingTemplates"
                                         rendered="#{CreateProcessForm.processDataTab.usingTemplates}"
                                         value="#{CreateProcessForm.mainProcess.inChoiceListShown}"/>
            </div>
        </p:row>

        <p:row>
            <div>
                <!-- Tifheader - Documentname -->
                <p:outputLabel for="tifHeaderDocumentName"
                               value="#{msgs.tifHeaderDocumentName}"/>
                <p:inputText class="input" id="tifHeaderDocumentName"
                             value="#{CreateProcessForm.processDataTab.tiffHeaderDocumentName}">
                    <p:ajax event="change"/>
                </p:inputText>
            </div>

            <div>
                <!-- Tifheader - Imagedescription -->
                <p:outputLabel for="tifHeaderImageDescription"
                               value="#{msgs.tifHeaderImageDescription}"/>
                <p:inputText class="input" id="tifHeaderImageDescription"
                             value="#{CreateProcessForm.processDataTab.tiffHeaderImageDescription}">
                    <p:ajax event="change"/>
                </p:inputText>
            </div>

            <div>
                <p:outputLabel for="guessImages"
                               value="#{msgs.guessImages}"/>
                <p:inputText class="input"
                             id="guessImages"
                             value="#{CreateProcessForm.processDataTab.guessedImages}">
                    <p:ajax event="change"/>
                </p:inputText>
            </div>
        </p:row>

    </p:panelGrid>
    <p:panelGrid id="processMetadata" layout="grid" columns="1">
        <p:panelGrid styleClass="metadataTitle ui-noborder"
                     rendered="#{not readOnly}"
                     layout="grid" columns="2">
            <p:row>
                <div>
                    <h:outputText value="#{msgs.metadata}"/>
                </div>
            </p:row>
            <p:row>
                <h:panelGroup id="addMetadataButtonWrapper"
                              title="#{CreateProcessForm.processMetadata.metadataAddableToStructureElement() ? msgs['dataEditor.addMetadata.newMetadata'] : msgs['dataEditor.addMetadata.noMetadataAddable']}">
                    <p:commandButton id="addMetadataButton"
                                     value="#{msgs['dataEditor.addMetadata.newMetadata']}"
                                     icon="fa fa-plus"
                                     styleClass="secondary"
                                     update="addMetadataDialog"
                                     disabled="#{not CreateProcessForm.processMetadata.metadataAddableToStructureElement()}"
                                     action="#{CreateProcessForm.addMetadataDialog.prepareAddableMetadataForStructure()}"
                                     oncomplete="PF('addMetadataDialog').show();">
                    </p:commandButton>
                </h:panelGroup>
            </p:row>
            <p:row>
                <p:outputLabel for="discard"
                               value="#{msgs['newProcess.discardUnknownMetadata']}"/>
                <p:selectBooleanCheckbox styleClass="switch input"
                                         id="discard"
                                         value="#{CreateProcessForm.discardUnknownMetadata}">
                        <p:ajax event="change"
                                update="editForm:processFromTemplateTabView:metadataTable"/>
                </p:selectBooleanCheckbox>
            </p:row>
        </p:panelGrid>

        <ui:include src="/WEB-INF/templates/includes/metadataTreeTable.xhtml">
            <ui:param name="root" value="#{CreateProcessForm.processMetadata.logicalMetadataTree}"/>
            <ui:param name="readOnly" value="#{false}"/>
            <ui:param name="discardUnknownMetadata" value="#{CreateProcessForm.discardUnknownMetadata}"/>
            <ui:param name="Form" value="#{CreateProcessForm}"/>
        </ui:include>
        <p:remoteCommand name="preserveMetadata"
                         actionListener="#{CreateProcessForm.processMetadata.preserve}"/>
    </p:panelGrid>
</ui:composition>
